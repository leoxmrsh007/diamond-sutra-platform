<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>修复验证页面</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .test-item { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
    .success { background: #d4edda; }
    .error { background: #f8d7da; }
    .info { background: #d1ecf1; }
  </style>
  <script>
    async function runTests() {
      const results = document.getElementById('results');
      
      const tests = [
        { name: 'icon-192.svg', url: '/icon-192.svg' },
        { name: 'icon-192.png', url: '/icon-192.png' },
        { name: 'manifest.json', url: '/manifest.json' },
        { name: 'platform-sutra', url: '/platform-sutra?chapter=1' },
      ];

      for (const test of tests) {
        const item = document.createElement('div');
        item.className = 'test-item';
        
        try {
          const response = await fetch(test.url);
          const status = response.status;
          
          if (status === 200) {
            item.className += ' success';
            item.textContent = `✅ ${test.name}: HTTP ${status}`;
          } else if (status === 404) {
            item.className += ' error';
            item.textContent = `❌ ${test.name}: HTTP 404 (Not Found)`;
          } else {
            item.className += ' info';
            item.textContent = `ℹ️ ${test.name}: HTTP ${status}`;
          }
        } catch (error) {
          item.className += ' error';
          item.textContent = `❌ ${test.name}: ${error.message}`;
        }
        
        results.appendChild(item);
      }

      // 检查 favicon
      const faviconDiv = document.createElement('div');
      faviconDiv.className = 'test-item info';
      const links = document.querySelectorAll('link[rel="icon"], link[rel="apple-touch-icon"]');
      let iconInfo = [];
      links.forEach(link => {
        iconInfo.push(\`\${link.rel}: \${link.href}\`);
      });
      faviconDiv.innerHTML = \`ℹ️ 页面图标引用:<br>\${iconInfo.join('<br>')}\`;
      results.appendChild(faviconDiv);
    }

    window.addEventListener('DOMContentLoaded', runTests);
  </script>
</head>
<body>
  <h1>修复验证页面</h1>
  <p>此页面测试所有修复后的功能</p>
  <div id="results"></div>
</body>
</html>
