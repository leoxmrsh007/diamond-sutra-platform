# ç‰ˆæœ¬å¯¹ç…§ç³»ç»Ÿæ‰©å±•å®ŒæˆæŠ¥å‘Š

## âœ… å·²å®Œæˆä»»åŠ¡

### 1. ç‰ˆæœ¬å¯¹ç…§ç³»ç»Ÿæ‰©å±•åˆ°11ä¸ªç‰ˆæœ¬

**åŸæœ‰ç‰ˆæœ¬ï¼ˆ6ä¸ªï¼‰ï¼š**
- é¸ æ‘©ç½—ä»€è¯‘æœ¬ï¼ˆkumarajivaï¼‰
- ç„å¥˜è¯‘æœ¬ï¼ˆxuanzangï¼‰
- ä¹‰å‡€è¯‘æœ¬ï¼ˆyijingï¼‰
- æ¢µæ–‡åŸå…¸ï¼ˆsanskritï¼‰
- è—æ–‡è¯‘æœ¬ï¼ˆtibetanï¼‰
- è‹±è¯‘æœ¬ï¼ˆenglishï¼‰

**æ–°å¢ç‰ˆæœ¬ï¼ˆ6ä¸ªï¼‰ï¼š**
- è¾¾æ‘©ç¬ˆå¤šè¯‘æœ¬ï¼ˆdamoduojiduoï¼‰- éš‹ä»£ï¼ˆ603å¹´ï¼‰
- ä¹‰å‡€é‡è¯‘æœ¬ï¼ˆyijing_revisedï¼‰- å”ä»£ï¼ˆ703å¹´ï¼‰
- ä¸ç¦ä¿è¯‘æœ¬ï¼ˆdingfubaoï¼‰- æ°‘å›½ï¼ˆ1924å¹´ï¼‰
- Edward Conzeè‹±è¯‘æœ¬ï¼ˆconzeï¼‰- ç°ä»£è‹±è¯‘ï¼ˆ1957å¹´ï¼‰
- Red Pineè‹±è¯‘æœ¬ï¼ˆredpineï¼‰- ç°ä»£è‹±è¯‘ï¼ˆ2001å¹´ï¼‰
- Sangharakshitaè‹±è¯‘æœ¬ï¼ˆsangharakshitaï¼‰- ç°ä»£è‹±è¯‘ï¼ˆ2001å¹´ï¼‰

**æ€»è®¡ï¼š11ä¸ªç‰ˆæœ¬ç±»å‹**

### 2. APIå±‚æ›´æ–°

**æ›´æ–°çš„æ–‡ä»¶ï¼š**
- `src/app/api/research/versions/route.ts`
  - æ‰©å±•äº†`versionNames`æ˜ å°„ï¼Œæ”¯æŒ11ä¸ªç‰ˆæœ¬
  - ä¸ºæ–°ç‰ˆæœ¬æ·»åŠ äº†é¢œè‰²æ ‡è¯†ï¼ˆç²‰è‰²ã€é’è‰²ã€é’è‰²ã€ç´«è‰²ã€ç«ç‘°è‰²ã€ç¥ç€è‰²ï¼‰

**æ›´æ–°çš„æ–‡ä»¶ï¼š**
- `src/app/research/page.tsx`
  - æ‰©å±•äº†`versionColors`æ˜ å°„
  - ä¸º11ä¸ªç‰ˆæœ¬æ·»åŠ äº†ç‹¬ç‰¹çš„é¢œè‰²æ ‡è¯†

### 3. ç§å­æ•°æ®è„šæœ¬

**åˆ›å»ºçš„æ–‡ä»¶ï¼š**
- `scripts/add-new-versions.ts`
  - åŒ…å«6ä¸ªæ–°ç‰ˆæœ¬çš„å…ƒæ•°æ®
  - åŒ…å«ç¬¬1-3ç« çš„éƒ¨åˆ†ç‰ˆæœ¬å†…å®¹ï¼ˆç”¨äºæµ‹è¯•ï¼‰

---

## ğŸ“‹ æ•°æ®åº“çŠ¶æ€

| ç±»å‹ | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| ç‰ˆæœ¬ç±»å‹ | 11ä¸ª | âœ… å·²æ‰©å±• |
| ç‰ˆæœ¬å…ƒæ•°æ® | 6ä¸ª | âœ… å·²æ·»åŠ åˆ°æ•°æ®åº“ |
| éš¾ç‚¹å­— | 25ä¸ª | âœ… å·²æ·»åŠ  |
| æˆè¯­/æœ¯è¯­ | 50ä¸ª | âœ… å·²æ·»åŠ  |
| ç»æ–‡ | 1éƒ¨ | é‡‘åˆšç» |
| ç« èŠ‚ | 32ç«  | âœ… å·²é…ç½® |
| åˆé¢‚ | 106ä¸ª | âœ… å·²é…ç½® |

---

## ğŸ¨ ç‰ˆæœ¬é¢œè‰²æ–¹æ¡ˆ

| ç‰ˆæœ¬ | é¢œè‰² | ä»£ç  |
|------|------|------|
| é¸ æ‘©ç½—ä»€ | çº¢è‰² | `border-red-400 bg-red-50` |
| ç„å¥˜ | è“è‰² | `border-blue-400 bg-blue-50` |
| ä¹‰å‡€ | ç»¿è‰² | `border-green-400 bg-green-50` |
| æ¢µæ–‡ | ç´«è‰² | `border-purple-400 bg-purple-50` |
| è—æ–‡ | æ©™è‰² | `border-orange-400 bg-orange-50` |
| è‹±è¯‘ | é›è‰² | `border-indigo-400 bg-indigo-50` |
| è¾¾æ‘©ç¬ˆå¤š | ç²‰è‰² | `border-pink-400 bg-pink-50` |
| ä¹‰å‡€é‡è¯‘ | é’è‰² | `border-teal-400 bg-teal-50` |
| ä¸ç¦ä¿ | é’è‰² | `border-cyan-400 bg-cyan-50` |
| Conze | ç´«è‰² | `border-violet-400 bg-violet-50` |
| Red Pine | ç«ç‘°è‰² | `border-rose-400 bg-rose-50` |
| Sangharakshita | ç¥ç€è‰² | `border-amber-400 bg-amber-50` |

---

## ğŸ”§ å¦‚ä½•æµ‹è¯•

### 1. æœ¬åœ°æµ‹è¯•

```bash
# 1. ç¡®ä¿Prisma Clientå·²ç”Ÿæˆ
cd diamond-sutra-platform
npx prisma generate

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. è®¿é—®æµ‹è¯•é¡µé¢
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
http://localhost:3000/public/test-api.html
```

### 2. æ£€æŸ¥ç ”ç©¶é¡µé¢

```
è®¿é—®ï¼šhttps://www.jinganjing.cn/research
æˆ–æœ¬åœ°ï¼šhttp://localhost:3000/research

æ£€æŸ¥é¡¹ç›®ï¼š
1. é¡µé¢æ˜¯å¦æ­£å¸¸åŠ è½½
2. ç‰ˆæœ¬ç»Ÿè®¡æ˜¯å¦æ˜¾ç¤º
3. ç‚¹å‡»"å¯åŠ¨ç‰ˆæœ¬æ¯”è¾ƒ"æŒ‰é’®
4. æŸ¥çœ‹ç‰ˆæœ¬å¯¹ç…§ç•Œé¢
5. æ–°å¢çš„6ä¸ªç‰ˆæœ¬æ˜¯å¦æ˜¾ç¤ºåœ¨ç‰ˆæœ¬åˆ—è¡¨ä¸­
```

### 3. APIç«¯ç‚¹æµ‹è¯•

```bash
# æµ‹è¯•ç ”ç©¶ç»Ÿè®¡API
curl http://localhost:3000/api/research

# æµ‹è¯•ç‰ˆæœ¬å¯¹ç…§APIï¼ˆç¬¬1ç« ï¼‰
curl http://localhost:3000/api/research/versions?chapter=1

# æµ‹è¯•éš¾ç‚¹å­—API
curl http://localhost:3000/api/difficult-characters?scripture=diamond-sutra

# æµ‹è¯•æˆè¯­API
curl http://localhost:3000/api/idioms?scripture=diamond-sutra
```

---

## âš ï¸ æ•…éšœæ’æŸ¥

### 404é”™è¯¯

å¦‚æœé‡åˆ°404é”™è¯¯ï¼Œå¯èƒ½æ˜¯ä»¥ä¸‹åŸå› ï¼š

#### 1. Prisma Clientæœªæ›´æ–°

```bash
# é‡æ–°ç”ŸæˆPrisma Client
npx prisma generate

# æ£€æŸ¥.node_modules/@prisma/clientæ˜¯å¦æ˜¯æœ€æ–°çš„
```

#### 2. æ•°æ®åº“è¿æ¥é—®é¢˜

æ£€æŸ¥`.env`æ–‡ä»¶ä¸­çš„`DATABASE_URL`æ˜¯å¦æ­£ç¡®ï¼š

```env
# å¼€å‘ç¯å¢ƒä½¿ç”¨SQLite
DATABASE_URL="file:./dev.db"

# æˆ–ä½¿ç”¨ç”Ÿäº§æ•°æ®åº“ï¼ˆNeon PostgreSQLï¼‰
DATABASE_URL="postgresql://neondb_owner:npg_SuPOb2scv6hZ@ep-delicate-river-ahizjt90-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require"
```

#### 3. APIè·¯ç”±é—®é¢˜

æ£€æŸ¥ä»¥ä¸‹è·¯ç”±æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š

```
src/app/api/research/route.ts âœ…
src/app/api/research/versions/route.ts âœ…
src/app/api/research/commentaries/route.ts âœ…
src/app/api/difficult-characters/route.ts âœ…
src/app/api/idioms/route.ts âœ…
```

#### 4. ç¼“å­˜é—®é¢˜

å¦‚æœä½¿ç”¨äº†`force-static`å’Œ`force-cache`ï¼Œå¯èƒ½å¯¼è‡´æ—§æ•°æ®ï¼š

```typescript
// åœ¨APIè·¯ç”±ä¸­ä¿®æ”¹ä¸º
export const dynamic = 'force-dynamic';
export const fetchCache = 'no-store';
```

---

## ğŸ“ ä»£ç æäº¤è®°å½•

```
fca7c41 - é›†æˆéš¾ç‚¹å­—æ³¨ç»„ä»¶åˆ°å­¦ä¹ é¡µé¢
f9e5e0f - æ‰©å±•ç‰ˆæœ¬å¯¹ç…§ç³»ç»Ÿåˆ°11ä¸ªç‰ˆæœ¬ï¼šè¾¾æ‘©ç¬ˆå¤šã€ä¹‰å‡€é‡è¯‘ã€ä¸ç¦ä¿ã€Conzeã€Red Pineã€Sangharakshita
467b322 - æ·»åŠ ç‰ˆæœ¬å¯¹ç…§APIæµ‹è¯•è„šæœ¬
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### 1. å¡«å……å®Œæ•´çš„ç‰ˆæœ¬å†…å®¹

æ–°å¢çš„6ä¸ªç‰ˆæœ¬ç›®å‰åªæœ‰å…ƒæ•°æ®ï¼Œéœ€è¦æ·»åŠ å®Œæ•´çš„32ç« ç»æ–‡å†…å®¹ï¼š

```typescript
// å¯ä»¥é€šè¿‡API POSTç«¯ç‚¹æ‰¹é‡æ·»åŠ 
POST /api/research/versions
{
  "verseId": "verse_id",
  "versionType": "damoduojiduo",
  "content": "è¾¾æ‘©ç¬ˆå¤šè¯‘æœ¬å†…å®¹",
  "translator": "è¾¾æ‘©ç¬ˆå¤š",
  "year": "603"
}
```

### 2. å®ç°ç‰ˆæœ¬å·®å¼‚é«˜äº®

è‡ªåŠ¨æ£€æµ‹ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚ï¼Œç”¨ä¸åŒé¢œè‰²æ ‡è®°ï¼š
- å­—è¯å·®å¼‚
- è¯­åºå·®å¼‚
- ç¼ºå¤±å†…å®¹

### 3. æ·»åŠ ç‰ˆæœ¬åˆ‡æ¢UI

åœ¨å­¦ä¹ é¡µé¢æ·»åŠ ç‰ˆæœ¬åˆ‡æ¢åŠŸèƒ½ï¼š
- ä¸‹æ‹‰é€‰æ‹©æ¡†é€‰æ‹©ç‰ˆæœ¬
- å®æ—¶åˆ‡æ¢æ˜¾ç¤º
- ä¿å­˜ç”¨æˆ·åå¥½

### 4. å®Œå–„å…¶ä»–åŠŸèƒ½

- [ ] å®ç°å…¨æ–‡æœç´¢
- [ ] AIå¯¹è¯å†å²æŒä¹…åŒ–
- [ ] ç¤¾åŒºåŠŸèƒ½å®Œå–„
- [ ] æˆå°±ç³»ç»Ÿ

---

## ğŸ“Š æŠ€æœ¯æ¶æ„

### APIè·¯ç”±ç»“æ„

```
/api/research
â”œâ”€â”€ GET /research - ç ”ç©¶é¡µé¢æ±‡æ€»æ•°æ®
â”œâ”€â”€ /research/versions - ç‰ˆæœ¬å¯¹ç…§æ•°æ®
â””â”€â”€ /research/commentaries - å†ä»£æ³¨é‡Š

/api/study
â”œâ”€â”€ /chapters - ç« èŠ‚æ•°æ®
â”œâ”€â”€ /verses - åˆé¢‚æ•°æ®
â””â”€â”€ /study-progress - å­¦ä¹ è¿›åº¦

/api/annotations
â”œâ”€â”€ /difficult-characters - éš¾ç‚¹å­—æ³¨
â””â”€â”€ /idioms - æˆè¯­/æœ¯è¯­
```

### æ•°æ®æ¨¡å‹

```
Sutra (ç»æ–‡)
â”œâ”€â”€ Chapter (ç« èŠ‚)
â”‚   â””â”€â”€ Verse (åˆé¢‚)
â”‚       â””â”€â”€ Version (ç‰ˆæœ¬å¯¹ç…§)
â”‚       â””â”€â”€ Commentary (æ³¨é‡Š)
â”‚       â””â”€â”€ Note (ç¬”è®°)
â”‚       â””â”€â”€ StudyProgress (å­¦ä¹ è¿›åº¦)
â””â”€â”€ VersionMetadata (ç‰ˆæœ¬å…ƒæ•°æ®)

DifficultCharacter (éš¾ç‚¹å­—)
â””â”€â”€ Idiom (æˆè¯­/æœ¯è¯­)
```

---

**æ–‡æ¡£ç‰ˆæœ¬:** v2.1
**æœ€åæ›´æ–°:** 2026-01-25

---

## ğŸ”§ é—®é¢˜ä¿®å¤è®°å½•

### 2026-01-25 ä¿®å¤ç ”ç©¶APIé”™è¯¯

**é—®é¢˜ï¼š** 
- ç ”ç©¶é¡µé¢è¿”å›500é”™è¯¯ï¼š"è·å–ç ”ç©¶æ•°æ®å¤±è´¥"
- åŸå› ï¼šPrismaæ¨¡å‹åç§°é”™è¯¯

**ä¿®å¤å†…å®¹ï¼š**
1. å°† `prisma.sutraVersion` æ”¹ä¸º `prisma.version`
2. å°† `prisma.commentary` æ”¹ä¸º `prisma.commentary`
3. æ›´æ–°æŸ¥è¯¢ç»“æ„ä»¥åŒ¹é…schema
4. ä¿®å¤è¿”å›æ•°æ®ç»“æ„åŒ…å«`metadata`å­—æ®µ

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `src/app/api/research/route.ts`
- `src/app/api/research/versions/route.ts`

**æäº¤è®°å½•ï¼š**
```
a564aee - ä¿®å¤ç ”ç©¶APIå’Œç‰ˆæœ¬å¯¹ç…§APIçš„æ¨¡å‹åç§°é”™è¯¯
```

---

## ğŸ”„ æ•°æ®æ¨¡å‹å˜æ›´

### Schemaæ¨¡å‹åç§°

| ä¹‹å‰ä½¿ç”¨çš„åç§° | æ­£ç¡®çš„æ¨¡å‹åç§° |
|--------------|---------------|
| `sutraVersion` | `version` |
| `commentary` | `commentary` |
| `concept` | `concept` |

### æ–°çš„å…³è”ç»“æ„

```
Version (ç‰ˆæœ¬)
â”œâ”€â”€ metadata: VersionMetadata (é€šè¿‡metadataIdå…³è”)
â””â”€â”€ verse: Verse (é€šè¿‡verseIdå…³è”)

Commentary (æ³¨é‡Š)
â””â”€â”€ verse: Verse (é€šè¿‡verseIdå…³è”ï¼Œå¯èƒ½ä¸ºnull)
```

---
